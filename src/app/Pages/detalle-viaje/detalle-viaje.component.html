
<app-header></app-header>
<main style="flex-grow: 1; display: flex; justify-content: center; align-items: center; ">
    <div class="card  card-paso2 container" style="max-width: 1000px; margin:50px 0px;">
        <div></div>
        <div class="card-body">
            <div class="row justify-content-center mt-4">
                <div class="col-sm-4">
                    <div class="card text-center">
                        <div class="card-header">
                            <h5 class="card-title"><span>{{viaje?.ruta?.terminalOrigen?.nombre}} | {{viaje?.ruta?.terminalDestino?.nombre}}</span></h5>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">Fecha: <span>{{viaje?.fechaSalida | date: 'dd/MM/yyyy'}}</span> </h5>
                            <p class="card-text">Hora: <span>{{viaje?.horaSalida}}</span> <br />Precio: <span id="spPrecio"></span> </p>
                            <p class="card-text">Precio: S/. {{ precioTotal | number:'1.2-2' }} </p>

                            <p class="card-text">*Seleccione asientos*</p>
                        </div>
                    </div>
                    <div class="d-flex">
                        <div  class="d-flex justify-content-center  align-items-center">
                            <div class="cuadrado rojo"></div>
                            <p>Ocupado</p>
                        </div>
                        <div class="d-flex justify-content-center  align-items-center">
                            <div class="cuadrado gris"></div>
                            <p>Disponible</p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4" id="divPiso1">
                    <div class="card shadow-light p-3 mb-5 bg-body rounded" style="width: 200px; margin: auto; position: relative;">
                        <h6 class="text-center">Primer Piso</h6>
                        <div class="seat-grid">
                            <ng-container *ngFor="let asiento of asientos; let i = index">
                                <div *ngIf="asiento.numeroPiso === 1 && (i % 2 === 0)">
                                    <div class="seat" 
                                        [ngClass]="{
                                            'selected-seat': seleccionados[asiento.numAsiento], 
                                            'occupied-seat': asiento.estadoAsiento && asiento.estadoAsiento.estado === 'OCUPADO'
                                        }" 
                                        (click)="toggleSeat(asiento)">
                                        {{ asiento.numAsiento }}
                                    </div>
                                </div>
                                <div *ngIf="asiento.numeroPiso === 1 && (i % 2 !== 0)">
                                    <div class="seat" 
                                        [ngClass]="{
                                            'selected-seat': seleccionados[asiento.numAsiento], 
                                            'occupied-seat': asiento.estadoAsiento && asiento.estadoAsiento.estado === 'OCUPADO'
                                        }" 
                                        (click)="toggleSeat(asiento)">
                                        {{ asiento.numAsiento }}
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                </div>
                
                <div class="col-sm-3" id="divPiso2">
                    <div class="card shadow-light p-3 mb-5 bg-body rounded" style="width: 200px; margin: auto; position: relative;">
                        <h6 class="text-center">Segundo Piso</h6>
                        <div class="seat-grid">
                            <ng-container *ngFor="let asiento of asientos; let i = index">
                                <div *ngIf="asiento.numeroPiso === 2 && (i % 2 === 0)">
                                    <div class="seat" 
                                        [ngClass]="{
                                            'selected-seat': seleccionados[asiento.numAsiento], 
                                            'occupied-seat': asiento.estadoAsiento && asiento.estadoAsiento.estado === 'OCUPADO'
                                        }" 
                                        (click)="toggleSeat(asiento)">
                                        {{ asiento.numAsiento }}
                                    </div>
                                </div>
                                <div *ngIf="asiento.numeroPiso === 2 && (i % 2 !== 0)">
                                    <div class="seat" 
                                        [ngClass]="{
                                            'selected-seat': seleccionados[asiento.numAsiento], 
                                            'occupied-seat': asiento.estadoAsiento && asiento.estadoAsiento.estado === 'OCUPADO'
                                        }" 
                                        (click)="toggleSeat(asiento)">
                                        {{ asiento.numAsiento }}
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="!hayAsientosSeleccionados()" class="alert alert-warning mt-3" role="alert">
            ¡Por favor, selecciona al menos un asiento para continuar!
        </div>
        <div *ngIf="hayAsientosSeleccionados()" class="alert alert-warning mt-3" role="alert">
            ¡Por favor, Solo puede seleccionar como maximo 5 asientos!
        </div>
        <div class="card-footer d-flex justify-content-end">
            <button class="btn btn-secondary me-2" id="btnRegresar">Regresar</button>
            <button class="btn btn-primary" (click)="Siguiente()">Continuar</button>
        </div>
        
    </div>
</main>
<app-footer></app-footer>
