<app-header></app-header>

<div class="container mt-4">
    <!-- Encabezado azul -->
    <div class="custom-header">
        <h1 class="text-center mb-0">Buses</h1>
    </div>

    <!-- Contenedor con border azul y bordes redondeados -->
    <div class="custom-container mt-0">
        <!-- Botón "Crear nuevo" en una fila separada -->
        <div class="row mb-3">
            <div class="col-md-12">
                <!-- Llama al método para agregar un nuevo bus y abre el modal -->
                <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#crearBusModal">+ Crear nuevo</button>
            </div>
        </div>

        <!-- Controles "Mostrar" y "Buscar" en la siguiente fila -->
        <div class="row mb-3">
            <div class="col-md-3">
                <label style="color: black;" for="mostrar">Mostrar:</label>
                <select class="form-select" id="mostrar">
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
            </div>
            <div class="col-md-6"></div> <!-- Espacio para centrar los formularios -->
            <div class="col-md-3">
                <label style="color: black;" for="buscar">Buscar:</label>
                <input type="text" class="form-control" id="buscar" #buscarInput (input)="buscarBus(buscarInput.value)">
            </div>
        </div>

        <!-- Tabla de buses -->
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Número placa</th>
                    <th>Nombre</th>
                    <th>Capacidad de piso 1</th>
                    <th>Capacidad de piso 2</th>
                    <th>Disponible</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let bus of buses">
                    <td>{{ bus.placa }}</td>
                    <td>{{ bus.nombre }}</td>
                    <td>{{ bus.capacidadPiso1 }}</td>
                    <td>{{ bus.capacidadPiso2 }}</td>
                    <td>{{ bus.disponible }}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" (click)="seleccionarBus(bus)" data-toggle="modal" data-target="#editarBusModal">
                            <i class="fas fa-edit"></i> Editar
                        </button>
                        <button class="btn btn-danger btn-sm" (click)="eliminarBus(bus)">
                            <i class="fas fa-trash-alt"></i> Eliminar
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Modal para crear un nuevo bus -->
<div class="modal fade" id="crearBusModal" tabindex="-1" aria-labelledby="crearBusModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="crearBusModalLabel" style="color: black;">Crear nuevo bus</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="numeroPlaca" class="form-label" style="color: black;">Número placa:</label>
                        <input type="text" class="form-control" [(ngModel)]="nuevoBus.placa" name="placa">
                    </div>
                    <div class="mb-3">
                        <label for="nombre" class="form-label" style="color: black;">Nombre:</label>
                        <input type="text" class="form-control" [(ngModel)]="nuevoBus.nombre" name="nombre">
                    </div>
                    <div class="mb-3">
                        <label for="capacidadPiso1" class="form-label" style="color: black;">Capacidad de piso 1:</label>
                        <input type="number" class="form-control" [(ngModel)]="nuevoBus.capacidadPiso1" name="capacidadPiso1">
                    </div>
                    <div class="mb-3">
                        <label for="capacidadPiso2" class="form-label" style="color: black;">Capacidad de piso 2:</label>
                        <input type="number" class="form-control" [(ngModel)]="nuevoBus.capacidadPiso2" name="capacidadPiso2">
                    </div>
                    <div class="mb-3">
                        <label for="disponible" class="form-label" style="color: black;">Disponible:</label>
                        <select class="form-select" [(ngModel)]="nuevoBus.disponible" name="disponible" style="width: 120px; height: 50px;">
                            <option value="SI">SI</option>
                            <option value="NO">NO</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" (click)="agregarBus()" data-bs-dismiss="modal">Crear</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para editar un bus -->
<div class="modal fade" id="editarBusModal" tabindex="-1" aria-labelledby="editarBusModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editarBusModalLabel" style="color: black;">Editar bus</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="numeroPlaca" class="form-label" style="color: black;">Número placa:</label>
                        <input type="text" class="form-control" [(ngModel)]="busEditando.placa" name="placa">
                    </div>
                    <div class="mb-3">
                        <label for="nombre" class="form-label" style="color: black;">Nombre:</label>
                        <input type="text" class="form-control" [(ngModel)]="busEditando.nombre" name="nombre">
                    </div>
                    <div class="mb-3">
                        <label for="capacidadPiso1" class="form-label" style="color: black;">Capacidad de piso 1:</label>
                        <input type="number" class="form-control" [(ngModel)]="busEditando.capacidadPiso1" name="capacidadPiso1">
                    </div>
                    <div class="mb-3">
                        <label for="capacidadPiso2" class="form-label" style="color: black;">Capacidad de piso 2:</label>
                        <input type="number" class="form-control" [(ngModel)]="busEditando.capacidadPiso2" name="capacidadPiso2">
                    </div>
                    <div class="mb-3">
                        <label for="disponible" class="form-label" style="color: black;">Disponible:</label>
                        <select class="form-select" [(ngModel)]="busEditando.disponible" name="disponible" style="width: 120px; height: 50px;">
                            <option value="SI">SI</option>
                            <option value="NO">NO</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" (click)="guardarCambiosBus()" data-bs-dismiss="modal">Guardar cambios</button>
            </div>
        </div>
    </div>
</div>


<!-- Modal para eliminar un bus -->
<div class="modal fade" id="eliminarBusModal" tabindex="-1" aria-labelledby="eliminarBusModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="eliminarBusModalLabel">Eliminar bus</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                ¿Estás seguro de eliminar este bus?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-danger" (click)="eliminarBus(busEditando)" data-bs-dismiss="modal">Eliminar</button>
            </div>
        </div>
    </div>
</div>
